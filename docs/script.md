---
title: "Поля файла с описанием игры"
---

### Сценарий

Сценарий содержит следующие поля:

- [***name***](#name)
- [***startScene***](#startScene)
- [***goodByeCommand***](#goodByeCommand)
- [***goodByeScene***](#goodByeScene)
- [***matchers***](#matchers)
- [***script***](#script)

##### <a id="name"></a> name - Имя игры
Указывается название реализуемой игры.
```yaml
name: 'echo_game'
```

##### <a id="startScene"></a> startScene - Стартовая сцена
Указывается название стартовой сцены которая описывается в разделе [***script***](#сцены-игры) с остальными сценами
```yaml
startScene: 'hello'
```

##### <a id="goodByeCommand"></a> goodByeCommand - Команда окончания игры
Указывается строка которая будет появляться в виде кнопке на каждой проигрываемой сцене.
При нажатие на данную кнопку будет вызываться сцена прощания.
```yaml
goodByeCommand: "Пока"
```

##### <a id="goodByeScene"></a> goodByeScene - Сцена прощания
Указывается сцена которая будет вызываться при желании игрока выйти из игры на основе реплик содержащих слова *Хватит*, *Закончить*.
Или при нажатии на кнопку окончания игры.
```yaml
goodByeScene: "goodbye"
```

##### <a id="matchers"></a> matchers - Описание правил проверки введённых данных
Описываются пользовательские наборы правил для проверки введённых данных.
Генератор поддерживает два типа таких наборов:
- Сопоставление пользовательского ввода с различными вариантами.
    * `selects` -- список вариантов, с которыми требуется сопоставить ввод пользователя.
      Для более корректной работы лучше указывать без каких-либо знаков препинания,
      а также избегать присутствия слов *Закончить* или *Хватит*, т.к. данные слова воспринимается Марусей как слова окончания игры
    * `replaceMessage` -- сообщение, которое будет использовано для идентификации набора с выполнившемся правилами.
      Также этим сообщением будет заменён пользовательский ввод
    * `BuyDrops` -- имя набора
```yaml
  BuyDrops:
    selects:
      - "Хочу купить капельки"
      - "Капельки"
      - "Купить капельки"
      - "Купить капли"
      - "Капли"
      - "Воду"
      - "Хочу купить воду"
      - "Хочу купить капли"
      - "Купить воду"
      - "Вода"
    replaceMessage: "Вода"
```

- Проверка на основе регулярных выражений
    * `regex` -- Правило основанное на регулярном выражении. Пользовательский ввод будет заменён на фразу, удовлетворяющею данному регулярному выражению
    * `nameMatched` -- сообщение, которое будет использовано для идентификации набора с выполнившемся правилами
    * `BuyDrops` -- имя набора
```yaml
  BuyDrops:
    regex: "* капли"
    nameMatched: "Вода"
```

##### <a id="script"></a> script - Сцены игры
Описывает список сцен из игры.

```yaml
script:
  goodbye:
    text:
      string: "GoodyBye"
      tts: "GoodyBye"
    nextScenes:
      - 'goodbye'
  hello:
    text:
      string: "Hello boy. Is number {number}"
      tts: "Hello boy. Is number {number}"
      values:
        number: 'int64'
    nextScene: 'echo'
    isInfoScene: true
    error:
      scene: "goodbye"
  echo:
    text:
      string: "I will Repeat you word"
      tts: "I will Repeat you word"
    nextScenes:
      - 'echoRepeat'
    matchers:
      - 'any'
    error:
      base: "number"
  echoRepeat:
    text:
      string: "You say {userText}"
      tts: "You say {userText}"
      values:
        userText: 'string'
    nextScenes:
      - 'echoRepeat'
    matchers:
      - 'any'
    error:
      base: "number"
```

### Сцена
Каждая сцена содержит следующие пункты:

* [***text***](#text)
* [***isInfoScene***](#isInfoScene)
* [***nextScenes/nextScene***](#nextScenes)
* [***buttons***](#buttons)
* [***matchers***](#matchers)
* [***error***](#error)


##### <a id="text"></a> text - Текст сцены
Описание текста который будет выводится пользователю в начале сцене. Поддерживается указание встраиваемых значений внутри строки.
Они записываются как `{nameValue}`. **Очень важно отсутствие пробелом между `{` и `}` и именем значения.**
* `string` -- текст, который будет выведен в сообщение
* `tts` -- текст, который будет озвучен марусей. Дополнительные правила составления tts можно посмотреть в [документации](https://dev.vk.com/marusia/tts) к Марусе.
* `values` -- значения, которые должны встраиваться в текст. **Эти значения обязательно должны присутствовать в обоих строках**
    * Представляет собой ключе значение `nameValue`:`type`. Поддерживаются все стандартные типы *Golang*.
      `nameValue` обязательно должен соответствовать указанному имени внутри строки.
```yaml
    text:
      string: "You say {userText}"
      tts: "You say {userText}"
      values:
        userText: 'string'
```

##### <a id="isInfoScene"></a> isInfoScene - Является ли сцена информационной
Указывается если данная сцена является информационной, т.е. у данной сцены не вызывается обработка ввода пользователя,
а берётся только текст для пользователя и вызывается следующая сцена.
Поэтому если сцена информационная, то требуется указывать **только одну следующую сцену с полем `nextScene`**.

Также если сцена информационная, то следующие поля не влияют на результат генерации: `buttons`, `matchers`, `error`.
```yaml
isInfoScene: true
```

##### <a id="nextScenes"></a> nextScenes - Следующие сцены
Имя следующей сцены, либо следующих сцен. Если сцена информационная, то требуется указывать
только одну сцену в поле `nextScene`, иначе список сцен в поле `nextScenes`.

```yaml
isInfoScene: true
nextScene: 'echo'
```

```yaml
 nextScenes:
   - 'echoRepeat'
```

##### <a id="buttons"></a> buttons - Кнопки показываемые в сцене
Описания кнопок которые будут показаны в текущей сцене
* `agree` -- имя кнопки
* `text` -- текст, который будет показан как текст на кнопке
* `URL` -- ссылка, которую нужно открыть по нажатию на эту кнопку. Если такой функционал не требуется, то следует не **указывать** это поле.
* `Payload` -- некоторая структура, которую нужно передать вместе с кнопкой.
  Когда кнопка будет нажата, вместе с текстом кнопки вернётся payload. *Генератор также генерирует структуры *go*, соответствующие описанным полям.*
```yaml
buttons:
  agree:
    text: "Ага"
    URL: "vk.com"
    Payload:
      ID: 2
```


##### <a id="matchers"></a> matchers - Имена наборов правил проверки пользовательского ввода
Имена наборов правил проверки пользовательского ввода. Есть следующие стандартные наборы:
* `number` -- Набор, выделяющий любое число из ввода пользователя
* `positive_number` -- Набор, выделяющий любое положительное число из ввода пользователя
* `positive_number_in_words` -- Набор, выделяющий любое положительное число слов в ввода пользователя
* `any` -- Набор, принимающий любое сообщение пользователя
* `first_word` -- Набор, выделяющий первое слово из сообщения пользователей
* `agree` -- Набор, определяющий согласие пользователя

```yaml
matchers:
  - "agree"
  - "Back"
```


##### <a id="error"></a> error - Текст сообщения на неверный ввод пользователя
Вызываемое сообщение или сцена в случае, если ни один из наборов правил не соответствует введённому сообщению пользователя
Есть три вида ошибок:
* Стандартная
    * `base` -- имя стандартной ошибки. Поддерживаются следующие
```yaml
error:
  base: "number"
```
* Сцена ошибки
  Будет вызвана названная сцена на неверный ввод пользователя
```yaml
error:
  scene: "goodbye"
```

* Текстовая ошибка
    * `name` -- имя ошибки. **Должно быть уникальным**. Используется для удобного обращения к тексту ошибки внутри кода.
    * `text` -- текст который выводится при
```yaml
error:
  name: "NotUnderstandHealSale"
  text: "Я не понимаю о чём вы. Хотите ли вы купить аптечку?"
```